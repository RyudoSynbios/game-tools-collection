import type { GameJson, ItemBitflag } from "$lib/types";

import { characterFragment } from "./utils/fragment";
import {
  characterEnum,
  characterList,
  characters,
  characterSupports,
  eliwoodChapters,
  hectorChapters,
  items,
  itemsGroups,
  lynChapters,
  lynEliwoodChapters,
  lynHectorChapters,
  soundRoomGallery,
  supportList,
} from "./utils/resource";

export const regex = "[!#$%&*+,-./0-9:;?A-Za-z¡¿À-ÄÇ-ÏÑ-ÔÖÙ-Üßà-äç-ïñ-ôöŒœªº]";

const template: GameJson = {
  validator: {
    regions: {
      europe: {
        0x0: [0x41, 0x47, 0x42, 0x2d, 0x46, 0x45, 0x37], // "AGB-FE7"
      },
      usa_australia: {
        0x0: [0x41, 0x47, 0x42, 0x2d, 0x46, 0x45, 0x37], // "AGB-FE7"
      },
      japan: {
        0x0: [0x41, 0x47, 0x42, 0x2d, 0x46, 0x45, 0x37], // "AGB-FE7"
      },
    },
    text: "Drag 'n' drop here or click to add a save file.",
    error: "Not a valid save file.",
  },
  items: [
    {
      id: "slots",
      length: 0xd8c,
      type: "container",
      instanceType: "tabs",
      instances: 3,
      enumeration: "Slot %d",
      onTabChange: "onSlotChange(%d)",
      prependSubinstance: [
        {
          name: "General",
          items: [
            {
              name: "Checksum",
              offset: 0x60,
              type: "checksum",
              dataType: "uint16",
              control: {
                offsetStart: 0x0,
                offsetEnd: 0x50,
              },
            },
            {
              id: "message",
              type: "message",
              message:
                "This save file contains a suspended chapter. You will need to restart the current chapter to see the changes.",
              hidden: true,
            },
            {
              name: "Related to Active Slot 1",
              offset: 0x9a,
              type: "variable",
              dataType: "uint8",
              hidden: true,
            },
            {
              type: "section",
              flex: true,
              items: [
                {
                  name: "Main Tale",
                  type: "bitflags",
                  hidden: true,
                  flags: [{ offset: 0xe, bit: 0, label: "Cleared" }],
                },
                {
                  name: "Lyn's Tale",
                  type: "bitflags",
                  flags: [{ offset: 0xe, bit: 1, label: "Cleared" }],
                },
                {
                  id: "taleProgression",
                  name: "Eliwood's Tale",
                  type: "bitflags",
                  flags: [
                    { offset: 0xe, bit: 2, label: "Normal Cleared" },
                    { offset: 0xe, bit: 5, label: "Hard Cleared" },
                  ],
                },
                {
                  id: "taleProgression",
                  name: "Hector's Tale",
                  type: "bitflags",
                  flags: [
                    { offset: 0xe, bit: 4, label: "Normal Cleared" },
                    { offset: 0xe, bit: 7, label: "Hard Cleared" },
                  ],
                },
              ],
            },
          ],
        },
      ],
      items: [
        {
          name: "Checksum",
          offset: 0x70,
          type: "checksum",
          dataType: "uint32",
          control: {
            offsetStart: 0x3f2c,
            offsetEnd: 0x4cb8,
          },
          overrideShift: {
            parent: 1,
            shift: 0x10,
          },
        },
        {
          type: "tabs",
          items: [
            {
              name: "General",
              items: [
                {
                  type: "section",
                  flex: true,
                  items: [
                    {
                      id: "name",
                      name: "Name",
                      offset: 0x3f4c,
                      length: 0x7,
                      type: "variable",
                      dataType: "string",
                      letterDataType: "uint8",
                      fallback: 0x20,
                      endCode: 0x0,
                      regex,
                      test: true,
                    },
                    {
                      name: "Birth Month",
                      offset: 0x3f57,
                      type: "variable",
                      dataType: "upper4",
                      resource: "birthMonths",
                    },
                    {
                      name: "Gender",
                      offset: 0x3f58,
                      type: "variable",
                      dataType: "lower4",
                      resource: "genders",
                    },
                  ],
                },
                {
                  type: "section",
                  flex: true,
                  items: [
                    {
                      id: "mainCharacter",
                      name: "Main Character",
                      offset: 0x3f47,
                      type: "variable",
                      dataType: "uint8",
                      resource: "mainCharacters",
                    },
                    {
                      name: "Difficulty",
                      offset: 0x3f40,
                      type: "variable",
                      dataType: "bit",
                      bit: 6,
                      resource: "difficulties",
                    },
                    {
                      name: "Progression",
                      offset: 0x3f40,
                      type: "variable",
                      dataType: "bit",
                      bit: 5,
                      resource: "progressions",
                    },
                    {
                      id: "currentChapter",
                      name: "Chapter",
                      offset: 0x3f3a,
                      type: "variable",
                      dataType: "uint8",
                      size: "lg",
                      autocomplete: true,
                    },
                  ],
                },
                {
                  type: "section",
                  flex: true,
                  items: [
                    {
                      name: "Playtime",
                      type: "group",
                      mode: "time",
                      items: [
                        {
                          offset: 0x3f2c,
                          type: "variable",
                          dataType: "uint32",
                          operations: [
                            { "/": 60 },
                            {
                              convert: {
                                from: "seconds",
                                to: "hours",
                              },
                            },
                          ],
                          max: 999,
                        },
                        {
                          offset: 0x3f2c,
                          type: "variable",
                          dataType: "uint32",
                          operations: [
                            { "/": 60 },
                            {
                              convert: {
                                from: "seconds",
                                to: "minutes",
                              },
                            },
                          ],
                          leadingZeros: 1,
                          max: 59,
                        },
                        {
                          offset: 0x3f2c,
                          type: "variable",
                          dataType: "uint32",
                          operations: [
                            { "/": 60 },
                            {
                              convert: {
                                from: "seconds",
                                to: "seconds",
                              },
                            },
                          ],
                          leadingZeros: 1,
                          max: 59,
                        },
                      ],
                    },
                    {
                      name: "Funds",
                      offset: 0x3f34,
                      type: "variable",
                      dataType: "uint32",
                      max: 999999,
                    },
                  ],
                },
              ],
            },
            {
              name: "Party",
              items: [
                {
                  id: "Party",
                  length: 0x24,
                  type: "container",
                  instanceType: "tabs",
                  instances: 52,
                  resource: "characterNames",
                  vertical: true,
                  items: [characterFragment("party", 0x3f74)],
                },
              ],
            },
            {
              name: "Merlinus Stock",
              items: [...Array(100).keys()].map((index) => ({
                type: "section",
                flex: true,
                noMargin: true,
                items: [
                  {
                    name: `Item ${index + 1}`,
                    offset: 0x46c4 + index * 0x2,
                    type: "variable",
                    dataType: "uint8",
                    resource: "items",
                    autocomplete: true,
                  },
                  {
                    name: "Durability",
                    offset: 0x46c5 + index * 0x2,
                    type: "variable",
                    dataType: "uint8",
                    max: 63,
                  },
                ],
              })),
            },
            {
              name: "Statistics",
              items: [
                {
                  type: "tabs",
                  items: [
                    {
                      name: "Characters",
                      items: [
                        {
                          length: 0x10,
                          type: "container",
                          instanceType: "tabs",
                          instances: 70,
                          resource: "characterEnum",
                          vertical: true,
                          flex: true,
                          items: [
                            {
                              name: "Battles",
                              offset: 0x4798,
                              type: "variable",
                              dataType: "uint16",
                              binary: {
                                bitStart: 2,
                                bitLength: 12,
                              },
                              max: 999,
                            },
                            {
                              name: "Wins",
                              offset: 0x4797,
                              type: "variable",
                              dataType: "uint16",
                              binary: {
                                bitStart: 0,
                                bitLength: 10,
                              },
                              max: 999,
                            },
                            {
                              name: "Losses",
                              offset: 0x478c,
                              type: "variable",
                              dataType: "uint8",
                            },
                            {
                              name: "Moves",
                              offset: 0x4793,
                              type: "variable",
                              dataType: "uint16",
                              binary: {
                                bitStart: 6,
                                bitLength: 10,
                              },
                              max: 1000,
                            },
                          ],
                        },
                      ],
                    },
                    {
                      name: "Chapters",
                      items: [
                        {
                          length: 0x4,
                          type: "container",
                          instanceType: "section",
                          instances: 48,
                          flex: true,
                          noMargin: true,
                          items: [
                            {
                              id: "statsChapter-%index%",
                              name: "Chapter %d",
                              offset: 0x4bec,
                              type: "variable",
                              dataType: "uint8",
                              binary: {
                                bitStart: 0,
                                bitLength: 7,
                              },
                              size: "lg",
                              autocomplete: true,
                            },
                            {
                              name: "Turns",
                              offset: 0x4bec,
                              type: "variable",
                              dataType: "uint16",
                              binary: {
                                bitStart: 7,
                                bitLength: 9,
                              },
                            },
                            {
                              name: "Playtime",
                              type: "group",
                              mode: "time",
                              items: [
                                {
                                  id: "statsChapterPlaytime",
                                  offset: 0x4bee,
                                  type: "variable",
                                  dataType: "uint16",
                                  operations: [
                                    { "*": 3 },
                                    {
                                      convert: {
                                        from: "seconds",
                                        to: "hours",
                                      },
                                    },
                                  ],
                                  max: 4,
                                },
                                {
                                  id: "statsChapterPlaytime",
                                  offset: 0x4bee,
                                  type: "variable",
                                  dataType: "uint16",
                                  operations: [
                                    { "*": 3 },
                                    {
                                      convert: {
                                        from: "seconds",
                                        to: "minutes",
                                      },
                                    },
                                  ],
                                  leadingZeros: 1,
                                  max: 59,
                                },
                                {
                                  id: "statsChapterPlaytime",
                                  offset: 0x4bee,
                                  type: "variable",
                                  dataType: "uint16",
                                  operations: [
                                    { "*": 3 },
                                    {
                                      convert: {
                                        from: "seconds",
                                        to: "seconds",
                                      },
                                    },
                                  ],
                                  leadingZeros: 1,
                                  max: 59,
                                },
                              ],
                            },
                          ],
                        },
                      ],
                    },
                  ],
                },
              ],
            },
            {
              name: "Configuration",
              flex: true,
              items: [
                {
                  name: "Animation",
                  offset: 0x3f6e,
                  type: "variable",
                  dataType: "uint8",
                  binary: {
                    bitStart: 1,
                    bitLength: 2,
                  },
                  resource: "configAnimations",
                },
                {
                  name: "Game Speed",
                  offset: 0x3f6c,
                  type: "variable",
                  dataType: "bit",
                  bit: 7,
                  resource: "configGameSpeeds",
                },
                {
                  name: "Text Speed",
                  offset: 0x3f6c,
                  type: "variable",
                  dataType: "uint8",
                  binary: {
                    bitStart: 5,
                    bitLength: 2,
                  },
                  resource: "configTextSpeeds",
                },
                {
                  name: "Terrain",
                  offset: 0x3f6c,
                  type: "variable",
                  dataType: "bit",
                  bit: 1,
                  resource: "optionBoolean",
                },
                {
                  name: "Unit",
                  offset: 0x3f6c,
                  type: "variable",
                  dataType: "uint8",
                  binary: {
                    bitStart: 2,
                    bitLength: 2,
                  },
                  resource: "configUnits",
                },
                {
                  name: "Combat",
                  offset: 0x3f6e,
                  type: "variable",
                  dataType: "uint8",
                  binary: {
                    bitStart: 3,
                    bitLength: 2,
                  },
                  resource: "configCombats",
                },
                {
                  name: "Show Objective",
                  offset: 0x3f6e,
                  type: "variable",
                  dataType: "bit",
                  bit: 0,
                  resource: "optionBoolean",
                },
                {
                  name: "Controller",
                  offset: 0x3f6e,
                  type: "variable",
                  dataType: "bit",
                  bit: 5,
                  resource: "optionBoolean",
                },
                {
                  name: "Subtitle Help",
                  offset: 0x3f6d,
                  type: "variable",
                  dataType: "bit",
                  bit: 7,
                  resource: "optionBoolean",
                },
                {
                  name: "Autocursor",
                  offset: 0x3f6c,
                  type: "variable",
                  dataType: "bit",
                  bit: 4,
                  resource: "optionBoolean",
                },
                {
                  name: "Music",
                  offset: 0x3f6d,
                  type: "variable",
                  dataType: "bit",
                  bit: 0,
                  resource: "optionBoolean",
                },
                {
                  name: "Sound Effects",
                  offset: 0x3f6d,
                  type: "variable",
                  dataType: "bit",
                  bit: 1,
                  resource: "optionBoolean",
                },
                {
                  name: "Window Color",
                  offset: 0x3f6d,
                  type: "variable",
                  dataType: "uint8",
                  binary: {
                    bitStart: 2,
                    bitLength: 2,
                  },
                  operations: [{ "+": 1 }],
                  min: 1,
                  max: 4,
                },
              ],
            },
          ],
        },
      ],
      appendSubinstance: [
        {
          name: "Extras",
          items: [
            {
              type: "tabs",
              vertical: true,
              items: [
                {
                  id: "linkArena",
                  name: "Link Arena",
                  items: [
                    {
                      name: "Checksum",
                      offset: 0xc0,
                      type: "checksum",
                      dataType: "uint32",
                      control: {
                        offsetStart: 0x67d0,
                        offsetEnd: 0x7044,
                      },
                    },
                    {
                      type: "tabs",
                      items: [
                        {
                          name: "Teams",
                          items: [
                            {
                              id: "laTeams",
                              length: 0xc8,
                              type: "container",
                              instanceType: "tabs",
                              instances: 10,
                              enumeration: "Team %d",
                              vertical: true,
                              items: [
                                {
                                  length: 0x24,
                                  type: "container",
                                  instanceType: "tabs",
                                  instances: 5,
                                  enumeration: "Character %d",
                                  prependSubinstance: [
                                    {
                                      name: "General",
                                      items: [
                                        {
                                          id: "name-arenaLink",
                                          name: "Name",
                                          offset: 0x67d0,
                                          length: 0x9,
                                          type: "variable",
                                          dataType: "string",
                                          letterDataType: "uint8",
                                          fallback: 0x20,
                                          endCode: 0x0,
                                          regex,
                                        },
                                      ],
                                    },
                                  ],
                                  items: [
                                    characterFragment("arenaLink", 0x67e4),
                                  ],
                                },
                              ],
                            },
                          ],
                        },
                        {
                          name: "Ranking",
                          items: [
                            {
                              id: "laRanking",
                              length: 0x10,
                              type: "container",
                              instanceType: "section",
                              instances: 10,
                              enumeration: "%o Place",
                              flex: true,
                              items: [
                                {
                                  id: "name",
                                  name: "Name",
                                  offset: 0x6fa8,
                                  length: 0x9,
                                  type: "variable",
                                  dataType: "string",
                                  letterDataType: "uint8",
                                  fallback: 0x20,
                                  endCode: 0x0,
                                  regex,
                                },
                                {
                                  name: "Points",
                                  offset: 0x6fa4,
                                  type: "variable",
                                  dataType: "uint24",
                                  binary: {
                                    bitStart: 5,
                                    bitLength: 16,
                                  },
                                },
                                {
                                  name: "Victory Condition",
                                  offset: 0x6fa4,
                                  type: "variable",
                                  dataType: "bit",
                                  bit: 4,
                                  resource: "victoryConditions",
                                },
                                {
                                  name: "Rank",
                                  offset: 0x6fa4,
                                  type: "variable",
                                  dataType: "uint24",
                                  binary: {
                                    bitStart: 0,
                                    bitLength: 2,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 4,
                                },
                                {
                                  name: "Players",
                                  offset: 0x6fa4,
                                  type: "variable",
                                  dataType: "uint24",
                                  binary: {
                                    bitStart: 2,
                                    bitLength: 2,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 2,
                                  max: 4,
                                },
                              ],
                            },
                          ],
                        },
                        {
                          id: "laRules",
                          name: "Rules",
                          flex: true,
                          items: [
                            {
                              name: "Hide Units",
                              offset: 0x6fa0,
                              type: "variable",
                              dataType: "bit",
                              bit: 0,
                              resource: "optionBoolean",
                            },
                            {
                              name: "Victory Condition",
                              offset: 0x6fa0,
                              type: "variable",
                              dataType: "bit",
                              bit: 2,
                              resource: "victoryConditions",
                            },
                            {
                              name: "AutoWeapon",
                              offset: 0x6fa0,
                              type: "variable",
                              dataType: "bit",
                              bit: 2,
                              resource: "optionBoolean",
                            },
                          ],
                        },
                      ],
                    },
                  ],
                },
                {
                  name: "Sound Room",
                  flex: true,
                  items: [
                    {
                      type: "section",
                      items: [
                        {
                          name: "Checksum",
                          offset: 0x711c,
                          type: "checksum",
                          dataType: "uint16",
                          control: {
                            offsetStart: 0x70fc,
                            offsetEnd: 0x711c,
                          },
                        },
                        {
                          name: "Musics",
                          type: "bitflags",
                          flags: [
                            { offset: 0x7107, bit: 4, label: "001. Opening: History Unveiled" },
                            { offset: 0x7107, bit: 2, label: "002. Fire Emblem Theme" },
                            { offset: 0x7100, bit: 5, label: "003. A Hint of Things to Come" },
                            { offset: 0x7100, bit: 6, label: "004. Road of Trials" },
                            { offset: 0x7100, bit: 7, label: "005. Destiny Enlaced by Fear" },
                            { offset: 0x7102, bit: 0, label: "006. Winds across the Plains" },
                            { offset: 0x70fc, bit: 1, label: "007. Precious Things" },
                            { offset: 0x70fc, bit: 2, label: "008. Companions" },
                            { offset: 0x70fc, bit: 3, label: "009. Friendship and Adventure" },
                            { offset: 0x70fd, bit: 2, label: "010. Distant Travels" },
                            { offset: 0x70fd, bit: 3, label: "011. Inescapable Fate" },
                            { offset: 0x70fc, bit: 4, label: "012. Dragon's Gate II" },
                            { offset: 0x70fd, bit: 1, label: "013. Winning Road" },
                            { offset: 0x70fd, bit: 0, label: "014. Binding Ties" },
                            { offset: 0x70fc, bit: 5, label: "015. Scars of the Scouring" },
                            { offset: 0x70fc, bit: 6, label: "016. Raise Your Spirits" },
                            { offset: 0x70fc, bit: 7, label: "017. Shadow Approaches" },
                            { offset: 0x70fd, bit: 4, label: "018. Enemies Appear" },
                            { offset: 0x70fd, bit: 5, label: "019. The Messenger" },
                            { offset: 0x70fd, bit: 6, label: "020. Darkness Comes" },
                            { offset: 0x70fe, bit: 0, label: "021. Dragon's Gate I" },
                            { offset: 0x70fd, bit: 7, label: "022. Nabata's Wandering Messenger" },
                            { offset: 0x70fe, bit: 1, label: "023. Legendary Inheritance" },
                            { offset: 0x70fe, bit: 2, label: "024. Raid!" },
                            { offset: 0x70fe, bit: 3, label: "025. Messenger from the Darkness" },
                            { offset: 0x70ff, bit: 7, label: "026. Strike" },
                            { offset: 0x7100, bit: 0, label: "027. Safeguard" },
                            { offset: 0x70fe, bit: 4, label: "028. Victory Now!" },
                            { offset: 0x70fe, bit: 5, label: "029. Rise to the Challenge" },
                            { offset: 0x70fe, bit: 6, label: "030. Softly with Grace" },
                            { offset: 0x70fe, bit: 7, label: "031. Everything into the Dark" },
                            { offset: 0x70ff, bit: 0, label: "032. Campaign of Fire" },
                            { offset: 0x70ff, bit: 4, label: "033. Blessing of the 8 Generals I" },
                            { offset: 0x70ff, bit: 1, label: "034. Healing" },
                            { offset: 0x70ff, bit: 2, label: "035. Curing" },
                            { offset: 0x70ff, bit: 5, label: "036. Receive the Blessings of Water" },
                            { offset: 0x70ff, bit: 6, label: "037. Ride the Wind" },
                            { offset: 0x70ff, bit: 3, label: "038. To the Heights" },
                            { offset: 0x7102, bit: 2, label: "039. An Unexpected Caller" },
                            { offset: 0x7102, bit: 3, label: "040. When the Rush Comes" },
                            { offset: 0x7100, bit: 2, label: "041. Land of Swirling Sands" },
                            { offset: 0x7105, bit: 6, label: "042. Ships and Homes" },
                            { offset: 0x7105, bit: 7, label: "043. Silent Ground" },
                            { offset: 0x7109, bit: 3, label: "044. The Inn" },
                            { offset: 0x7104, bit: 1, label: "045. Going My Way" },
                            { offset: 0x7104, bit: 2, label: "046. Together, We Ride!" },
                            { offset: 0x7104, bit: 3, label: "047. A Knight's Oath" },
                            { offset: 0x7104, bit: 4, label: "048. Happiness Abounds" },
                            { offset: 0x7105, bit: 4, label: "049. Merlinus" },
                            { offset: 0x7104, bit: 0, label: "050. Final Farewell" },
                            { offset: 0x7100, bit: 1, label: "051. Requiem" },
                            { offset: 0x7106, bit: 1, label: "052. Recollection of a Petal" },
                            { offset: 0x7102, bit: 4, label: "053. The Cogs of Fate" },
                            { offset: 0x7102, bit: 7, label: "054. The Eight Generals" },
                            { offset: 0x7103, bit: 4, label: "055. The Archsage Athos" },
                            { offset: 0x7107, bit: 5, label: "056. Distant Utopia" },
                            { offset: 0x7106, bit: 2, label: "057. What Comes from Darkness" },
                            { offset: 0x7106, bit: 0, label: "058. Black Fang" },
                            { offset: 0x7105, bit: 2, label: "059. Calamity Bringer: Nergal's Theme" },
                            { offset: 0x7103, bit: 3, label: "060. Nergal's Wrath" },
                            { offset: 0x7106, bit: 3, label: "061. Stratagem" },
                            { offset: 0x7100, bit: 3, label: "062. The Kingdom of Biran" },
                            { offset: 0x7100, bit: 4, label: "063. Biran - A Mother's Wish" },
                            { offset: 0x7102, bit: 5, label: "064. Shocking Truth I" },
                            { offset: 0x7102, bit: 6, label: "065. Shocking Truth II" },
                            { offset: 0x7103, bit: 0, label: "066. Triumph" },
                            { offset: 0x7103, bit: 1, label: "067. Into the Shadow of Triumph" },
                            { offset: 0x7104, bit: 5, label: "068. Main Theme Arrangement" },
                            { offset: 0x7109, bit: 6, label: "069. Blessing of the 8 Generals II" },
                            { offset: 0x7103, bit: 7, label: "070. Girl of the Plains: Lyn's Theme" },
                            { offset: 0x7106, bit: 4, label: "071. Lyn's Desire" },
                            { offset: 0x7105, bit: 3, label: "072. Light to Tomorrow" },
                            { offset: 0x7103, bit: 5, label: "073. One Heart: Eliwood's Theme" },
                            { offset: 0x7106, bit: 6, label: "074. Eyes of Sorrow" },
                            { offset: 0x7106, bit: 7, label: "075. Unshakable Faith" },
                            { offset: 0x7103, bit: 6, label: "076. Loyalty: Hector's Theme" },
                            { offset: 0x7107, bit: 0, label: "077. The Grieving Heart" },
                            { offset: 0x7103, bit: 2, label: "078. Reminiscence" },
                            { offset: 0x7109, bit: 0, label: "079. Shattered Life" },
                            { offset: 0x7109, bit: 1, label: "080. Anguish" },
                            { offset: 0x7109, bit: 2, label: "081. Respite in Battle" },
                            { offset: 0x7105, bit: 1, label: "082. Prepare to Charge" },
                            { offset: 0x7105, bit: 5, label: "083. Armory" },
                            { offset: 0x7104, bit: 6, label: "084. Shop" },
                            { offset: 0x7107, bit: 6, label: "085. Fortune-Telling" },
                            { offset: 0x7104, bit: 7, label: "086. Arena Entrance" },
                            { offset: 0x7105, bit: 0, label: "087. Arena Battle" },
                            { offset: 0x7101, bit: 5, label: "088. Arena Victory" },
                            { offset: 0x7101, bit: 6, label: "089. Arena Tactics" },
                            { offset: 0x7101, bit: 4, label: "090. Within Sadness" },
                            { offset: 0x7101, bit: 3, label: "091. Game Over" },
                            { offset: 0x710a, bit: 3, label: "092. Legend of Athos" },
                            { offset: 0x7101, bit: 1, label: "093. Results" },
                            { offset: 0x7101, bit: 2, label: "094. Treasured Hope" },
                            { offset: 0x710a, bit: 0, label: "095. Beneath a New Light" },
                            { offset: 0x710a, bit: 1, label: "096. The Path to Greatness" },
                            { offset: 0x710a, bit: 2, label: "097. In the Name of Biran" },
                            { offset: 0x710a, bit: 4, label: "098. Avoided Fate" },
                            { offset: 0x710a, bit: 5, label: "099. Legend of the Dragon God" },
                            { offset: 0x710a, bit: 6, label: "100. Royal Palace of Silezha" },
                            { offset: 0x70fc, bit: 0, label: "???", hidden: true },
                            { offset: 0x7101, bit: 0, label: "???", hidden: true },
                            { offset: 0x7101, bit: 7, label: "???", hidden: true },
                            { offset: 0x7102, bit: 1, label: "???", hidden: true },
                            { offset: 0x7106, bit: 5, label: "???", hidden: true },
                            { offset: 0x7107, bit: 1, label: "???", hidden: true },
                            { offset: 0x7107, bit: 3, label: "???", hidden: true },
                            { offset: 0x7107, bit: 7, label: "???", hidden: true },
                            { offset: 0x7108, bit: 0, label: "???", hidden: true },
                            { offset: 0x7108, bit: 1, label: "???", hidden: true },
                            { offset: 0x7108, bit: 2, label: "???", hidden: true },
                            { offset: 0x7108, bit: 3, label: "???", hidden: true },
                            { offset: 0x7108, bit: 4, label: "???", hidden: true },
                            { offset: 0x7108, bit: 5, label: "???", hidden: true },
                            { offset: 0x7108, bit: 6, label: "???", hidden: true },
                            { offset: 0x7108, bit: 7, label: "???", hidden: true },
                            { offset: 0x7109, bit: 4, label: "???", hidden: true },
                            { offset: 0x7109, bit: 5, label: "???", hidden: true },
                            { offset: 0x7109, bit: 7, label: "???", hidden: true },
                            { offset: 0x710a, bit: 7, label: "???", hidden: true },
                            { offset: 0x710b, bit: 0, label: "???", hidden: true },
                            { offset: 0x710b, bit: 1, label: "???", hidden: true },
                            { offset: 0x710b, bit: 2, label: "???", hidden: true },
                            { offset: 0x710b, bit: 3, label: "???", hidden: true },
                            { offset: 0x710b, bit: 4, label: "???", hidden: true },
                            { offset: 0x710b, bit: 5, label: "???", hidden: true },
                            { offset: 0x710b, bit: 6, label: "???", hidden: true },
                            { offset: 0x710b, bit: 7, label: "???", hidden: true },
                          ],
                        },
                      ],
                    },
                    {
                      type: "section",
                      items: [
                        {
                          name: "Checksum",
                          offset: 0x7130,
                          type: "checksum",
                          dataType: "uint16",
                          control: {
                            offsetStart: 0x7120,
                            offsetEnd: 0x7130,
                          },
                        },
                        {
                          type: "section",
                          flex: true,
                          items: [...Array(3).keys()].map((region) => ({
                            id: `soundRoomGallery-${region}`,
                            name: "Gallery",
                            type: "bitflags",
                            hidden: true,
                            flags: soundRoomGallery.reduce(
                              (gallery: ItemBitflag[], image) => {
                                const index = image.regionIndexes[region];

                                if (index !== undefined) {
                                  gallery.push({
                                    offset: 0x7120 + Math.floor(index / 0x8),
                                    bit: index % 8,
                                    label: image.name,
                                  });
                                }

                                return gallery;
                              },
                              [],
                            ),
                          })),
                        },
                      ],
                    },
                  ],
                },
                {
                  name: "Support Conversation",
                  items: [
                    {
                      type: "tabs",
                      vertical: true,
                      items: characterSupports.map((character) => ({
                        name: character.name,
                        items: [
                          {
                            name: "Status",
                            offset:
                              0x40 + Math.floor((0x1 + character.index) / 0x8),
                            type: "variable",
                            dataType: "bit",
                            bit: (1 + character.index) % 8,
                            resource: "booleanUnlocked",
                          },
                          {
                            type: "section",
                            flex: true,
                            items: character.conversations.map(
                              (conversation) => ({
                                name: conversation.character,
                                offset:
                                  0x20 + Math.floor(conversation.index / 0x4),
                                type: "variable",
                                dataType: "uint8",
                                binary: {
                                  bitStart: (conversation.index * 0x2) % 8,
                                  bitLength: 2,
                                },
                                resource: `conversationLevels${conversation.level}`,
                              }),
                            ),
                          },
                        ],
                      })),
                    },
                  ],
                },
                {
                  name: "Battle History",
                  items: [
                    {
                      name: "Checksum",
                      offset: 0x70d4,
                      type: "checksum",
                      dataType: "uint16",
                      control: {
                        offsetStart: 0x7044,
                        offsetEnd: 0x70d4,
                      },
                    },
                    {
                      length: 0x18,
                      type: "container",
                      instanceType: "tabs",
                      instances: 3,
                      resource: "tales",
                      items: [
                        {
                          length: 0x48,
                          type: "container",
                          instanceType: "tabs",
                          instances: 2,
                          resource: "difficulties",
                          items: [
                            {
                              type: "section",
                              flex: true,
                              items: [
                                {
                                  name: "Progression",
                                  offset: 0x7044,
                                  type: "variable",
                                  dataType: "bit",
                                  bit: 0,
                                  resource: "progressions",
                                },
                                {
                                  name: "Display Name",
                                  offset: 0x7046,
                                  type: "variable",
                                  dataType: "bit",
                                  bit: 6,
                                  hidden: true,
                                },
                                {
                                  id: "name",
                                  name: "Name",
                                  offset: 0x7050,
                                  length: 0x7,
                                  type: "variable",
                                  dataType: "string",
                                  letterDataType: "uint8",
                                  fallback: 0x20,
                                  endCode: 0x0,
                                  regex,
                                },
                                {
                                  id: "bhScore",
                                  name: "Score",
                                  offset: 0x7046,
                                  type: "variable",
                                  dataType: "uint16",
                                  binary: {
                                    bitStart: 7,
                                    bitLength: 8,
                                  },
                                },
                                {
                                  name: "Screens",
                                  offset: 0x704e,
                                  type: "variable",
                                  dataType: "uint16",
                                  binary: {
                                    bitStart: 5,
                                    bitLength: 6,
                                  },
                                  max: 36,
                                },
                              ],
                            },
                            {
                              type: "section",
                              flex: true,
                              items: [
                                {
                                  name: "Assets",
                                  offset: 0x704b,
                                  type: "variable",
                                  dataType: "uint32",
                                  binary: {
                                    bitStart: 5,
                                    bitLength: 24,
                                  },
                                  max: 10000000,
                                },
                                {
                                  name: "Playtime",
                                  type: "group",
                                  mode: "time",
                                  items: [
                                    {
                                      offset: 0x7048,
                                      type: "variable",
                                      dataType: "uint16",
                                      binary: {
                                        bitStart: 7,
                                        bitLength: 8,
                                      },
                                    },
                                    {
                                      offset: 0x704a,
                                      type: "variable",
                                      dataType: "uint8",
                                      binary: {
                                        bitStart: 1,
                                        bitLength: 6,
                                      },
                                      leadingZeros: 1,
                                      max: 59,
                                    },
                                    {
                                      offset: 0x704a,
                                      type: "variable",
                                      dataType: "uint16",
                                      binary: {
                                        bitStart: 7,
                                        bitLength: 6,
                                      },
                                      leadingZeros: 1,
                                      max: 59,
                                    },
                                  ],
                                },
                              ],
                            },
                            {
                              type: "section",
                              flex: true,
                              items: [
                                {
                                  name: "Tactics",
                                  offset: 0x7044,
                                  type: "variable",
                                  dataType: "uint8",
                                  binary: {
                                    bitStart: 4,
                                    bitLength: 3,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 5,
                                },
                                {
                                  name: "Survival",
                                  offset: 0x7044,
                                  type: "variable",
                                  dataType: "uint16",
                                  binary: {
                                    bitStart: 7,
                                    bitLength: 3,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 5,
                                },
                                {
                                  name: "Funds",
                                  offset: 0x7045,
                                  type: "variable",
                                  dataType: "uint8",
                                  binary: {
                                    bitStart: 2,
                                    bitLength: 3,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 5,
                                },
                                {
                                  name: "Experience",
                                  offset: 0x7045,
                                  type: "variable",
                                  dataType: "uint8",
                                  binary: {
                                    bitStart: 5,
                                    bitLength: 3,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 5,
                                },
                                {
                                  name: "Combat",
                                  offset: 0x7046,
                                  type: "variable",
                                  dataType: "uint8",
                                  binary: {
                                    bitStart: 0,
                                    bitLength: 3,
                                  },
                                  operations: [{ "+": 1 }],
                                  min: 1,
                                  max: 5,
                                },
                              ],
                            },
                          ],
                        },
                      ],
                    },
                  ],
                },
              ],
            },
          ],
        },
      ],
    },
  ],
  resources: {
    birthMonths: {
      0x0: "January",
      0x1: "February",
      0x2: "March",
      0x3: "April",
      0x4: "May",
      0x5: "June",
      0x6: "July",
      0x7: "August",
      0x8: "September",
      0x9: "October",
      0xa: "November",
      0xb: "December",
    },
    booleanUnlocked: {
      0x0: "-",
      0x1: "Unlocked",
    },
    characterEnum,
    characterNames: "getCharacterNames()",
    characters: {
      0x0: "-",
      ...characters,
    },
    classes: {
      0x0: "-",
      0x1: "Lord (Eliwood)",
      0x2: "Lord (Lyn)",
      0x3: "Lord (Hector)",
      0x4: "Knight Lord (Eliwood)",
      0x5: "Blade Lord (Lyn)",
      0x6: "Great Lord (Hector)",
      0x7: "Knight Lord (Eliwood)",
      0x8: "Blade Lord (Lyn)",
      0x9: "Great Lord (Hector)",
      0xa: "Mercenary (Male)",
      0xb: "Mercenary (Female)",
      0xc: "Hero (Male)",
      0xd: "Hero (Female)",
      0xe: "Myrmidon (Male)",
      0xf: "Myrmidon (Female)",
      0x10: "Swordmaster (Male)",
      0x11: "Swordmaster (Female)",
      0x12: "Fighter",
      0x13: "Warrior",
      0x14: "Knight (Male)",
      0x15: "Knight (Female)",
      0x16: "General (Male)",
      0x17: "General (Female)",
      0x18: "Archer (Male)",
      0x19: "Archer (Female)",
      0x1a: "Sniper (Male)",
      0x1b: "Sniper (Female)",
      0x1c: "Monk",
      0x1d: "Cleric",
      0x1e: "Bishop (Male)",
      0x1f: "Bishop (Female)",
      0x20: "Mage (Male)",
      0x21: "Mage (Female)",
      0x22: "Sage (Male)",
      0x23: "Sage (Female)",
      0x24: "Shaman (Male)",
      0x25: "Shaman (Female)",
      0x26: "Druid (Male)",
      0x27: "Druid (Female)",
      0x28: "Cavalier (Male)",
      0x29: "Cavalier (Female)",
      0x2a: "Paladin (Male)",
      0x2b: "Paladin (Female)",
      0x2c: "Troubadour",
      0x2d: "Valkyrie",
      0x2e: "Nomad (Male)",
      0x2f: "Nomad (Female)",
      0x30: "Nmd Trooper (Male)",
      0x31: "Nmd Trooper (Female)",
      0x32: "Peg Knight",
      0x33: "Falcoknight",
      0x34: "Wyvern Rider (Male)",
      0x35: "Wyvern Rider (Female)",
      0x36: "Wyvern Lord (Male)",
      0x37: "Wyvern Lord (Female)",
      0x38: "Soldier",
      0x39: "Brigand",
      0x3a: "Pirate",
      0x3b: "Berserker",
      0x3c: "Thief (Male)",
      0x3d: "Thief (Female)",
      0x3e: "Assassin",
      0x3f: "Civilian",
      0x40: "Dancer",
      0x41: "Bard",
      0x42: "Archsage",
      0x43: "Magic Seal",
      0x44: "Transporter",
      0x45: "Dark Druid",
      0x46: "Fire Dragon",
      0x47: "Civilian",
      0x48: "Civilian",
      0x4a: "Bramimond",
      0x4b: "Peer",
      0x4c: "Peer",
      0x4d: "Prince",
      0x4e: "Queen",
      0x4f: "Civilian",
      0x50: "Corsair",
      0x51: "Prince",
      0x52: "Prince",
      0x53: "Prince",
      0x54: "Child",
      0x55: "Fire Dragon",
      0x56: "Warrior",
      0x57: "Child",
      0x58: "Child",
      0x59: "Transporter",
      0x5a: "Sage",
    },
    configAnimations: {
      0x0: "1",
      0x1: "Off",
      0x2: "Solo",
      0x3: "2",
    },
    configCombats: {
      0x0: "Strat",
      0x1: "Detail",
      0x2: "Off",
    },
    configGameSpeeds: {
      0x0: "Normal",
      0x1: "Fast",
    },
    configTextSpeeds: {
      0x0: "Slow",
      0x1: "Normal",
      0x2: "Fast",
      0x3: "Max",
    },
    configUnits: {
      0x0: "Panel",
      0x1: "Burst",
      0x2: "Off",
    },
    conversationLevels2: {
      0x0: "-",
      0x1: "C",
      0x2: "B",
    },
    conversationLevels3: {
      0x0: "-",
      0x1: "C",
      0x2: "B",
      0x3: "A",
    },
    difficulties: {
      0x0: "Normal",
      0x1: "Hard",
    },
    eliwoodChapters,
    emptyChapters: {
      0x0: "-",
    },
    genders: {
      0x0: "Male",
      0x1: "Female",
    },
    hectorChapters,
    items: {
      0x0: "-",
      ...items,
    },
    lynChapters,
    lynEliwoodChapters,
    lynHectorChapters,
    mainCharacters: {
      0x1: "Lyn",
      0x2: "Eliwood",
      0x3: "Hector",
    },
    optionBoolean: {
      0x0: "On",
      0x1: "Off",
    },
    progressions: {
      0x0: "-",
      0x1: "Cleared",
    },
    status: {
      0x0: "-",
      0x1: "Defeated",
    },
    tales: {
      0x0: "Lyn's Tale",
      0x1: "Eliwood's Tale",
      0x2: "Hector's Tale",
    },
    victoryConditions: {
      0x0: "Point",
      0x1: "Survival",
    },
  },
  resourcesGroups: {
    items: itemsGroups,
  },
  resourcesOrder: {
    configAnimations: [0x0, 0x3, 0x1, 0x2],
  },
};

export default template;
